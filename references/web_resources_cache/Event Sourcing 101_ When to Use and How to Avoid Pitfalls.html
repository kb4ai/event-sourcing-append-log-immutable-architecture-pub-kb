<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Learn about the basics of event sourcing and its benefits, challenges, and practical use cases to decide if it's the right fit for your software project.">
  <meta name="keywords" content="Event store, event, snapshot, Scalability">

  <meta property="og:description" content="Learn about the basics of event sourcing and its benefits, challenges, and practical use cases to decide if it's the right fit for your software project.">
  <meta property="og:site_name" content="dzone.com">
  <meta property="og:title" content="Event Sourcing 101: When to Use and How to Avoid Pitfalls">
  <meta property="og:url" content="https://dzone.com/articles/event-sourcing-guide-when-to-use-avoid-pitfalls">
  <meta property="og:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/18278455-thumb.jpg">
  <meta property="og:type" content="article">

  <meta name="twitter:site" content="@DZoneInc">
  <meta name="twitter:image" content="https://dz2cdn1.dzone.com/storage/article-thumb/18278455-thumb.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:description" content="Learn about the basics of event sourcing and its benefits, challenges, and practical use cases to decide if it's the right fit for your software project.">
  <meta name="twitter:title" content="Event Sourcing 101: When to Use and How to Avoid Pitfalls">


  <meta name="referrer" content="origin-when-cross-origin">
  <meta name="google-site-verification" content="kndbhxcupfEqWmZclhCpB6vlgOs7QSmx2UHAGGnP2mA">
  <meta name="df-verify" content="df0d76632b4543">

  <link rel="icon" type="image/x-icon" href="https://dz2cdn1.dzone.com/themes/dz20/images/favicon.png">
  <link rel="image_src" href="https://dz2cdn1.dzone.com/storage/article-thumb/18278455-thumb.jpg">
  <link rel="canonical" href="https://dzone.com/articles/event-sourcing-guide-when-to-use-avoid-pitfalls">

  <title>Event Sourcing 101: When to Use and How to Avoid Pitfalls</title>

  <link rel="preload" href="https://dz2cdn1.dzone.com/themes/dz20/font/fontello.woff?11773374" as="font" type="font/woff" crossorigin="anonymous">

  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/icons.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/article/global.css">
  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/header-updated/styles.css">
<style>
    :root {
	    --xs-size: 2px;
        --sm-size: 5px;
        --md-size: 10px;
        --lg-size: 15px;
        --xl-size: 25px;
        --sm-border-size: 8px;
        --sm-font-size: 13px;
        --sm-plus-font-size: 16px;
        --md-font-size: 18px;
        --lg-font-size: 22px;
        --xl-font-size: 26px;
    }

    /* Display Quick-Access Classes */
    .display-none { display: none; }
    .display-block { display: block; }
    .display-inline { display: inline; }
    .display-inline-block { display: inline-block; }

    /* Margin Quick-Access Classes */
    .m-xs { margin: var(--xs-size); }
    .m-sm { margin: var(--sm-size); }
    .m-md { margin: var(--md-size); }
    .m-lg { margin: var(--lg-size); }
    .m-xl { margin: var(--xl-size); }

    .mt-xs, .my-xs { margin-top: var(--xs-size); }
    .mr-xs, .mx-xs { margin-right: var(--xs-size); }
    .mb-xs, .my-xs { margin-bottom: var(--xs-size); }
    .ml-xs, .mx-xs { margin-left: var(--xs-size); }

    .mt-sm, .my-sm { margin-top: var(--sm-size); }
    .mr-sm, .mx-sm { margin-right: var(--sm-size); }
    .mb-sm, .my-sm { margin-bottom: var(--sm-size); }
    .ml-sm, .mx-sm { margin-left: var(--sm-size); }

    .mt-md, .my-md { margin-top: var(--md-size); }
    .mr-md, .mx-md { margin-right: var(--md-size); }
    .mb-md, .my-md { margin-bottom: var(--md-size); }
    .ml-md, .mx-md { margin-left: var(--md-size); }

    .mt-lg, .my-lg { margin-top: var(--lg-size); }
    .mr-lg, .mx-lg { margin-right: var(--lg-size); }
    .mb-lg, .my-lg { margin-bottom: var(--lg-size); }
    .ml-lg, .mx-lg { margin-left: var(--lg-size); }

    .mt-xl, .my-xl { margin-top: var(--xl-size); }
    .mr-xl, .mx-xl { margin-right: var(--xl-size); }
    .mb-xl, .my-xl { margin-bottom: var(--xl-size); }
    .ml-xl, .mx-xl { margin-left: var(--xl-size); }

    .ml-auto, .mx-auto { margin-left: auto; }
    .mr-auto, .mx-auto { margin-right: auto; }
    .mt-auto, .my-auto { margin-top: auto; }
    .mb-auto, .my-auto { margin-bottom: auto; }

    .my-none, .mt-none { margin-top: 0 !important; }
    .mx-none, .mr-none { margin-right: 0 !important; }
    .my-none, .mb-none { margin-bottom: 0 !important; }
    .mx-none, .ml-none { margin-left: 0 !important; }

    /* Padding Quick-Access Classes */
    .p-xs { padding: var(--xs-size); }
    .p-sm { padding: var(--sm-size); }
    .p-md { padding: var(--md-size); }
    .p-lg { padding: var(--lg-size); }
    .p-xl { padding: var(--xl-size); }

    .pt-xs, .py-xs { padding-top: var(--xs-size); }
    .pr-xs, .px-xs { padding-right: var(--xs-size); }
    .pb-xs, .py-xs { padding-bottom: var(--xs-size); }
    .pl-xs, .px-xs { padding-left: var(--xs-size); }

    .pt-sm, .py-sm { padding-top: var(--sm-size); }
    .pr-sm, .px-sm { padding-right: var(--sm-size); }
    .pb-sm, .py-sm { padding-bottom: var(--sm-size); }
    .pl-sm, .px-sm { padding-left: var(--sm-size); }

    .pt-md, .py-md { padding-top: var(--md-size); }
    .pr-md, .px-md { padding-right: var(--md-size); }
    .pb-md, .py-md { padding-bottom: var(--md-size); }
    .pl-md, .px-md { padding-left: var(--md-size); }

    .pt-lg, .py-lg { padding-top: var(--lg-size); }
    .pr-lg, .px-lg { padding-right: var(--lg-size); }
    .pb-lg, .py-lg { padding-bottom: var(--lg-size); }
    .pl-lg, .px-lg { padding-left: var(--lg-size); }

    .pt-xl, .py-xl { padding-top: var(--xl-size); }
    .pr-xl, .px-xl { padding-right: var(--xl-size); }
    .pb-xl, .py-xl { padding-bottom: var(--xl-size); }
    .pl-xl, .px-xl { padding-left: var(--xl-size); }

    .py-none, .pt-none { padding-top: 0 !important; }
    .px-none, .pr-none { padding-right: 0 !important; }
    .py-none, .pb-none { padding-bottom: 0 !important; }
    .px-none, .pl-none { padding-left: 0 !important; }

    /* Flex Quick-Access Classes */
    .flex {
	    display: flex;
    }

    .flex-column {
        display: flex;
        flex-direction: column;
    }

    .flex-column-reverse {
	    display: flex;
	    flex-direction: column-reverse;
    }

    .flex-row {
        display: flex;
        flex-direction: row;
    }

    .flex-row-reverse {
	    display: flex;
	    flex-direction: row-reverse;
    }

    .flex-wrap {
        flex-wrap: wrap;
    }

    .flex-grow {
        flex-grow: 1;
    }

    .align-center { align-items: center; }
    .align-end { align-items: flex-end; }

    .content-center {
	    align-content: center;
    }

    .justify-center { justify-content: center; }
    .justify-start { justify-content: flex-start; }
    .justify-end { justify-content: flex-end; }
    .justify-around { justify-content: space-around; }
    .justify-between { justify-content: space-between; }
    .justify-evenly { justify-content: space-evenly; }

    .gap-sm { gap: var(--sm-size); }
    .gap-md { gap: var(--md-size); }
    .gap-lg { gap: var(--lg-size); }
    .gap-xl { gap: var(--xl-size); }

    /* Display Quick-Access Classes */
    .inline-block { display: inline-block; }

    /* Font Quick-Access Classes */
    .font-xl { font-size: var(--xl-font-size); }
    .font-lg { font-size: var(--lg-font-size); }
    .font-md { font-size: var(--md-font-size); }
    .font-sm-plus { font-size: var(--sm-plus-font-size); }
    .font-sm { font-size: var(--sm-font-size); }

    .font-strike { text-decoration: line-through; }
    .font-underline { text-decoration: underline; }
    .font-overline { text-decoration: overline; }

    .font-italic { font-style: italic; }
    .font-bold { font-weight: bold; }

    .font-black { color: #000000; }
    .font-white { color: #ffffff; }
    .font-gray { color: var(--brand-gray-text); }
    .font-danger { color: var(--header-dropdown-button-bg-danger); }
    .font-center { text-align: center; }

    .no-wrap { white-space: nowrap; }

    /* Consistent headings between h and non-h tags */
    .heading {
	    margin-top: 0;
	    margin-bottom: var(--md-size);
    }

    .heading.font-xl { line-height: var(--xl-font-size); }
    .heading.font-lg { line-height: var(--lg-font-size); }
    .heading.font-md { line-height: var(--md-font-size); }
    .heading.font-sm-plus { line-height: var(--sm-plus-font-size); }
    .heading.font-sm { line-height: var(--sm-font-size); }

    /* Font Clamp Quick-Access Classes */
    .line-clamp,
    .line-clamp-2,
    .line-clamp-3,
    .line-clamp-4,
    .line-clamp-5 {
        display: -webkit-box;
        -webkit-line-clamp: 4;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .line-clamp-2 { -webkit-line-clamp: 2 !important; }
    .line-clamp-3 { -webkit-line-clamp: 3 !important; }
    .line-clamp-4 { -webkit-line-clamp: 4 !important; }
    .line-clamp-5 { -webkit-line-clamp: 5 !important; }

    /* User-Select Quick-Access Classes */
    .select-none { user-select: none; }

    /* Position Quick-Access Classes */
    .absolute { position: absolute; }
    .relative { position: relative; }
    .float-left { float: left; }
    .float-right { float: right; }

    .pos-top { top: 0; }
    .pos-right { right: 0; }
    .pos-bottom { bottom: 0; }
    .pos-left { left: 0; }

    .va-top { vertical-align: top; }
    .va-middle { vertical-align: middle; }
    .va-bottom { vertical-align: bottom; }

    /* Transition Quick-Access Classes */
    .trans-linear-quick {
        transition: all 0.15s linear;
    }

    /* Background Quick-Access Classes */
    .bg-gray { background: #cccccc; }
    .bg-white { background-color: white; }
    .bg-none { background: none; }

    /* Border Quick-Access Classes */
    .border-gray { border: 1px solid #cccccc; }
    .tab-pane.border-gray { border: 1px solid #ddd; }
    .no-border, .border-none { border: none !important; }

    .bt-none { border-top: none !important; }
    .br-none { border-right: none !important; }
    .bb-none { border-bottom: none !important; }
    .bl-none { border-left: none !important; }

    /* Border Radius Quick-Access Classes */

    .round-t-sm, .round-tl-sm { border-top-left-radius: var(--sm-border-size); }
    .round-t-sm, .round-tr-sm { border-top-right-radius: var(--sm-border-size); }
    .round-b-sm, .round-bl-sm { border-bottom-left-radius: var(--sm-border-size); }
    .round-b-sm, .round-br-sm { border-bottom-right-radius: var(--sm-border-size); }
    .round-sm { border-radius: var(--sm-border-size); }
    .round-fully { border-radius: 50%; }

    /* Misc Quick-Access Classes */
    .haikei {
        position: relative;
        background-image: url('https://dz2cdn1.dzone.com/themes/dz20/images/polygon-scatter-haikei-shapes.svg');
        background-repeat: no-repeat;
        background-size: cover;
    }

    .haikei:before {
        content: '';
        position:absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--color-event-background);
        z-index: -1;
    }

    .margin-auto-center {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    .flex-auto-center {
        display: flex;
        margin-left: auto;
        margin-right: auto;
    }

    .mw-1100 { max-width: 1100px; }
    .mw-1300 { max-width: 1300px; }
    .full-width { width: 100%; }

    .h-separator {
        background-color: #cccccc;
        height: 1px;
        width: 100%;
        margin: 5px auto;
    }

    .no-spacing {
        margin: 0 !important;
        padding: 0 !important;
    }

    .inherit-color { color: inherit; }

    .inherit-decoration { text-decoration: inherit; }

    /* Table Quick-Access Classes */
    .table-border-gray tr:not(:last-child) {
        border-bottom: 1px solid #cccccc;
    }

    table.full-width tr td:last-child {
        width:100%;
    }

    /* Animation Quick-Access Classes */
    @keyframes anim-spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(359deg); }
    }

    .anim-spin {
        display: inline-block;
        animation: anim-spin 2s infinite linear;
    }

    .hov-pointer { cursor: pointer; }
    .hov-brighten:hover { filter: brightness(1.2); }
    .hov-darken:hover { filter: brightness(0.95); }
    .hov-underline:hover { text-decoration: underline; }

    /* Small tweaks related to components when using these styles */
    .nav-tabs {
        border-bottom: none;
    }
    .tab-content > .flex-column.active,
    .tab-content > .flex-row.active {
        display: flex;
    }

    /* Alpine components with x-cloak should not be visible by default until conditionals kick in */
    [x-cloak] { display: none !important; }
</style>
  <link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/alpine-components/modal.css">
  <script defer src="https://dz2cdn1.dzone.com/themes/dz20/lib/alpinejs/3.13.2/cdn.min.js"></script>
<script>
	document.addEventListener('alpine:init', () => {
		Alpine.store('article', {
			id: null,
			engagement: {
				open: false,
				page: 1,
				users: [],
				additional: true,
				loading: false,
				initializing: false,
				unauthorized: false,
				enqueued: null,
				dequeued: null,

				reset() {
					this.open = false;
					this.page = 1;
					this.users.splice(0);
					this.additional = true;
					this.loading = false;
					this.initializing = false;
					this.enqueued = null;
					this.dequeued = null;
				},

				enqueue(user) {
					this.dequeued = null;
					this.enqueued = user;
				},

				dequeue(user) {
					this.enqueued = null;
					this.dequeued = user;
				},

				add(user) {
					this.users.push(user);
					this.enqueued = null;
				},

				remove(user) {
					const index = this.users.findIndex(u => u.id === user.id);

					if (index !== -1) {
						this.users.splice(index, 1);
					}

					this.dequeued = null;
				},

				contains(user) {
					return this.users.filter(u => u.id === user.id).length;
				}
			}
		});

		Alpine.effect(() => {
			const store = Alpine.store('article');
			if (!store.engagement.additional && store.engagement.enqueued) {
				if (!store.engagement.contains(store.engagement.enqueued)) {
					store.engagement.add(store.engagement.enqueued);
				}
			}
		});

		Alpine.effect(() => {
			const store = Alpine.store('article');
			if (store.engagement.page && store.engagement.dequeued) {
				store.engagement.remove(store.engagement.dequeued);
			}
		})
	});
</script></head>
<body x-data>
<header id="ftl-header">
    <div class="header-top">
<div class="header-container">
    <div class="pull-left logo-container">
        <div class="logo">
            <a class="inner" href="/">
                <picture>
                    <source srcset="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.webp" type="image/webp">
                    <source srcset="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" type="image/png">
                    <img src="https://dz2cdn1.dzone.com/themes/dz20/images/dz_logo_2021_cropped.png" width="181" height="56" alt="DZone">
                </picture>
            </a>
        </div>
    </div>

    <div class="pull-right login-and-search">
        <div id="authenticated-block" class="logged-in">
            <div class="welcome-back">Thanks for visiting DZone today,</div>
            <div id="user-header" class="user-info">
                <button class="user-avatar">
                    <span id="header-username" class="username"></span>
                    <img id="header-avatar" src="" alt="user avatar">
                </button>
                <div id="user-dropdown" class="browse-user-menu">
                    <div class="user-content">
                        <a id="header-user-plug" href="#" class="user-description"></a>
                        <a id="header-user-edit" href="#" class="edit-profile">Edit Profile</a>
                    </div>
                    <ul class="user-actions">
                        <li id="first-user-action">
                            <a id="header-dropdown-manage-email" href="#">Manage Email Subscriptions</a>
                        </li>
                        <li>
                            <a href="/articles/how-to-submit-a-post-to-dzone?utm_source=DZone&utm_medium=user_dropdown&utm_campaign=how_to_post">
                                How to Post to DZone
                            </a>
                        </li>
                        <li>
                            <a href="/articles/dzones-article-submission-guidelines">
                                Article Submission Guidelines
                            </a>
                        </li>
                    </ul>
                    <div class="bottom">
                        <a href="/users/logout.html" class="sign-out">Sign Out</a>
                        <a id="dropdown-view-profile" href="#" class="view-profile">View Profile</a>
                    </div>
                </div>
            </div>

            <div class="post-content">
                <button id="post-button" class="post-content--button">
                    <span class="post-class">Post</span>
                    <i class="icon-plus"></i>
                </button>

                <div id="post-menu" class="posting-links">
                    <div class="posting-links-menu">
                        <ul>
                            <li>
                                <img src="https://dz2cdn1.dzone.com/themes/dz20/images/dz-postarticle.svg" width="15" height="18" style="width: 15px; height: 18px;">
                                <a href="/content/article/post.html">Post an Article</a>
                            </li>
                            <li>
                                <a id="drafts-link" href="#">Manage My Drafts</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="unauthenticated-block">
            <div class="dz-intro">Over 2 million developers have joined DZone.</div>
            <div class="mobile-invisible sign-in-join">
                <a href="/users/login.html">Log In</a>
                <span class="dz-intro-span">/</span>
                <a href="/static/registration.html">Join</a>
            </div>
            <a class="join-icon" href="/users/login.html"><i class="icon-user"></i></a>
        </div>

        <script>
            document.addEventListener('alpine:init', () => {
                Alpine.data('searchDrawer', () => ({
                    open: false,
                    query: '',
                    minCharsMet: false,

                    toggleVisibility() {
                        this.open = !this.open;
                        if (this.open) {
                            this.$nextTick(() => {
                                this.$refs.query.focus();
                            });
                        }
                    },

                    updateSearchValue() {
                        if (!this.query || !this.query.length || this.query.length < 3) {
                            this.minCharsMet = false;
                            return;
                        }
                        this.minCharsMet = true;
                        localStorage.setItem('ls.searchValue', this.query);
                    },

                    searchSite() {
                        if (this.minCharsMet) {
                            window.location = '/search';
                        }
                    }
                }));
            });
        </script>

        <div class="headerSearch" x-data="searchDrawer()" x-cloak>
            <button class="icon-search dropdown-toggle" x-on:click="toggleVisibility()"></button>
            <template x-teleport=".header-container">
                <div id="search-drawer" x-show="open" x-on:click.outside="open = false" x-transition>
                    <div class="search-input">
                        <input type="text"
                               placeholder="Search"
                               autofocus="autofocus"
                               x-model="query"
                               x-ref="query"
                               x-on:input.change="updateSearchValue()"
                               x-on:keyup.enter="searchSite()"
                        >
                        <button x-on:click="searchSite()" x-bind:disabled="!minCharsMet">
                            <span>Search</span>
                        </button>
                    </div>
                    <div class="search-footer">
                        Please enter at least three characters to search
                    </div>
                </div>
            </template>
        </div>
    </div>
</div>    </div>
    <div class="header-bottom">
        <div class="header-bottom-container">
            <a class="resource-link" href="/refcardz">Refcards</a>
            <a class="resource-link" href="/trendreports">Trend Reports</a>
            <div class="resource-link link-menu">
                <a href="/events">Events</a>
                <a href="/events/video-library">Video Library</a>
            </div>
        </div>
    </div>
    <nav class="header-menu-bar">
        <div class="header-menu resource-category">
            <a href="/refcardz">Refcards</a>
        </div>
        <div class="header-menu-separator resource-category-separator"></div>
        <div class="header-menu resource-category">
            <a href="/trendreports">Trend Reports</a>
        </div>
        <div class="header-menu-separator resource-category-separator"></div>
        <div class="header-menu resource-category no-bottom-radius" tabindex="1" data-click-activation>
            <p class="menu-label">Events</p>
            <div class="header-menu-items">
                <div class="header-menu-columns">
                    <a class="header-menu-item" href="/events">View Events</a>
                    <a class="header-menu-item" href="/events/video-library">Video Library</a>
                </div>
            </div>
        </div>
    </nav>
</header>

<script>
    const csrf = {
        parameter: 'TH_CSRF',
        header: 'X-TH-CSRF',
        token: '-6199661504942448446'
    }; // set csrf for auth-status script
</script>
<script>
addEventListener('DOMContentLoaded', function() {
    handleRedirects();
    handleMenus();
    handleMobileMenuHeights();
    handleGotoLinks();
});

function isHidden(element) {
    try {
        return window.getComputedStyle(element).display === 'none';
    } catch (_) {
        return false;
    }
}

function getLink(element) {
    if (element.hasAttribute('data-goto')) {
        return element.getAttribute('data-goto');
    }
    return element.href;
}

function isLeftClick(event) {
    if (event.altKey || event.shiftKey) {
        return false;
    } else if ('buttons' in event || 'which' in event) {
        return event.buttons === 1 || event.which === 1;
    } else {
        return (event.button === 1 || (event.type === 'click'));
    }
}

function handleRedirects() {
    const redirections = [...document.querySelectorAll('[data-activate-menu]'), ...document.querySelectorAll('[data-click-target]')];

    redirections.forEach(function(element) {
        const menuSelector = element.getAttribute('data-activate-menu') || element.getAttribute('data-click-target');
        const redirectingElement = document.querySelector(menuSelector);
        if (redirectingElement) {
            element.style.cursor = 'pointer';
            const redirect = function(e) {
                if (redirectingElement.hasAttribute('href') || redirectingElement.hasAttribute('data-goto')) {
                    if (redirectingElement.hasAttribute('data-new-window') || e.ctrlKey || e.metaKey) {
                        window.open(getLink(redirectingElement), '_blank');
                    } else {
                        window.open(getLink(redirectingElement), '_self');
                    }
                } else {
                    const evt = new e.constructor(e.type, e);
                    redirectingElement.dispatchEvent(evt);
                }
            };
            element.addEventListener('mouseup', redirect);
            element.addEventListener('mousedown', (e) => e.preventDefault());
            element.addEventListener('click', (e) => e.preventDefault());
        }
    });
}

function handleMenus() {
    const menuElements = [
        ...document.querySelectorAll('.header-menu > a'),
        ...document.querySelectorAll('.header-menu > p.menu-label')
    ];

    let scrollYMemory = -1;

    function scrollToMemory() {
        if (scrollYMemory !== -1) {
            setTimeout(function() {
                window.scrollTo(0, scrollYMemory);
                scrollYMemory = -1;
            }, 10);
        }
    }

    function hideMenus() {
        // unfocus menus & items, and set the menus to non-visible.
        menuElements.forEach(function (element) {
            element.blur();
            element.parentElement.blur();
            element.parentElement.classList.remove('menu-opened');
            const menuItems = element.parentElement.querySelector('.header-menu-items');
            if (menuItems) {
                menuItems.style.display = 'none';
            }
        });
        const wasHidden = document.body.style.overflowY === 'hidden';
        document.body.style.overflowY = 'auto';
        if (wasHidden) {
            scrollToMemory();
        }
    }

    function isEventOutsideMenu(e) {
        return e.target.closest && !e.target.closest('.header-menu') && !e.target.closest('[data-activate-menu]');
    }

    // Handle mobile menu toggling
    menuElements.forEach(function(element) {
        const menu = element.parentElement;
        const headerItems = menu.querySelector('.header-menu-items');
        const menuEntries = headerItems ? headerItems.querySelectorAll('.header-menu-item') : [];

        const focus = function() {
            menu.focus();
            menu.classList.add('menu-opened');
            if (headerItems) {
                headerItems.style.display = 'block';
            }
            if (menu.classList.contains('zone-menu')) {
                scrollYMemory = window.scrollY;
                document.body.style.overflowY = 'hidden';
            } else {
                scrollYMemory = -1;
            }
        };

        const unfocus = function() {
            menu.blur();
            menu.classList.remove('menu-opened');
            if (headerItems) {
                headerItems.style.display = 'none';
            }
            const wasHidden = document.body.style.overflowY === 'hidden';
            document.body.style.overflowY = 'auto';
            if (wasHidden) {
                scrollToMemory();
            }
        };

        const toggleMenuVisibility = function(e) {
            if ((e.type === 'click' || e.type === 'mouseup') && !isLeftClick(e)) {
                e.preventDefault();
                return;
            }
            const hidden = isHidden(headerItems);
            if (menu.hasAttribute('data-click-activation')) { // handle click activated toggling
                if (hidden) {
                    hideMenus(); // hide other open menus first
                    focus();
                } else {
                    unfocus();
                }
                e.preventDefault();
            } else if (hidden) {
                hideMenus(); // hide other open menus first
                focus();
                e.preventDefault(); // prevent 'click' event from firing when menu is hidden
            }
        };

        element.addEventListener('touchend', toggleMenuVisibility);
        element.addEventListener('mouseup', toggleMenuVisibility);

        // Add hover events to non-click-activated menus, even though CSS should cover it.
        if (!menu.hasAttribute('data-click-activation')) {
            menu.addEventListener('mouseover', function () {
                hideMenus(); // hide other open menus first
                focus();
            });

            menu.addEventListener('mouseout', function (e) {
                if (isEventOutsideMenu(e)) {
                    unfocus();
                }
            });
        }

        // Hide menu when child is clicked
        menuEntries.forEach(function(menuEntry) {
            const linkToItem = function(e) {
                if (e.type === 'mousedown' || e.type === 'click') {
                    e.preventDefault();
                    return;
                }
                if (e.type === 'mouseup' && !isLeftClick(e)) {
                    e.preventDefault();
                    return;
                }
                window.open(getLink(menuEntry), (e.ctrlKey || e.metaKey) ? '_blank' : (menuEntry.target || '_self'));
                unfocus();
                e.preventDefault();
            };

            const linkToMobileItem = function(e) {
                if (e.type === 'touchstart') {
                    menuEntry.setAttribute('data-touchmove', false);
                } else if (e.type === 'touchmove') {
                    menuEntry.setAttribute('data-touchmove', true);
                } else if (e.type === 'touchend' && (!menuEntry.hasAttribute('data-touchmove') || menuEntry.getAttribute('data-touchmove').toLowerCase() === 'false')) {
                    window.open(getLink(menuEntry), (e.ctrlKey || e.metaKey) ? '_blank' : (menuEntry.target || '_self'));
                    unfocus();
                    e.preventDefault();
                }
            };

            menuEntry.addEventListener('mousedown', linkToItem);
            menuEntry.addEventListener('mouseup', linkToItem);
            menuEntry.addEventListener('click', linkToItem);
            menuEntry.addEventListener('touchstart', linkToMobileItem);
            menuEntry.addEventListener('touchmove', linkToMobileItem);
            menuEntry.addEventListener('touchend', linkToMobileItem);
        });
    });

    function hideIfNonMenuBounds(e) {
        if (isEventOutsideMenu(e)) {
            hideMenus();
        }
    }

    addEventListener('mousemove', hideIfNonMenuBounds);
    addEventListener('touchend', hideIfNonMenuBounds);
    addEventListener('mouseup', hideIfNonMenuBounds);
    addEventListener('mousedown', hideIfNonMenuBounds);
    addEventListener('click', hideIfNonMenuBounds);
}

function handleMobileMenuHeights() {
    function setAppHeight() {
        document.documentElement.style.setProperty('--app-height', window.innerHeight + 'px');
    }

    addEventListener('resize', function() {
        setAppHeight();
    });

    setAppHeight();
}

function handleGotoLinks() {
    // Add anchor mimicking to elements with data-goto attributes
    // This addresses SEO concerns of linking to noindex pages by allowing JS to handle the URL
    const anchorElements = document.querySelectorAll('*[data-goto]');
    anchorElements.forEach((anchorElement) => {
        anchorElement.addEventListener('mouseover', () => {
            anchorElement.style.cursor = 'pointer';
            anchorElement.style.textDecoration = 'underline';
        });
        anchorElement.addEventListener('mouseout', () => {
            anchorElement.style.cursor = 'unset';
            anchorElement.style.textDecoration = 'unset';
        });
        anchorElement.addEventListener('mouseup', (e) => {
            e.preventDefault();
        });
        anchorElement.addEventListener('mousedown', (e) => {
            e.preventDefault();
        });
        anchorElement.addEventListener('click', (e) => {
            e.preventDefault();
            const anchorHref = anchorElement.getAttribute('data-goto');
            if (anchorElement.hasAttribute('data-new-window') || e.ctrlKey || e.metaKey) {
                window.open(anchorHref, '_blank');
            } else {
                window.open(anchorHref, '_self');
            }
        });
    });
}
</script><script>
const authenticatedBlock = document.querySelector('#authenticated-block');
const unauthenticatedBlock = document.querySelector('#unauthenticated-block');

let authenticated = {
    isAuthenticated: false,
    isAdmin: false,
	user: {
		id: null,
		name: null,
		url: null,
		profileImage: null,
	}
};

fetch('/services/internal/data/articles-getAuthenticationStatus', {
    headers: {
        'Accept': 'application/json'
    }
})
    .then(function (result) {
        return result.json()
    })
    .then(function (result) {
        const res = result.result.data
        if (!res.authenticated) {
            unauthenticatedBlock.classList.add('shown')
        } else {
			authenticated.user.id = res.id;
			authenticated.user.name = res.realName;
			authenticated.user.url = res.profileUrl;
			authenticated.user.profileImage = res.avatar;
			authenticated.user.jobTitle = res.jobTitle;
			authenticated.user.companyName = res.companyName;

            bindProps('#header-username', null, null, (res.firstName || res.username), null)
            bindProps('#header-avatar', null, res.avatar, null, null)
            bindProps('#header-user-plug', res.profileUrl, null, res.realName, null)
            bindProps('#header-user-edit', '/users/' + res.id + '/edit.html', null, null, null)
            bindProps('#header-dropdown-manage-email', '/newsletters/' + res.id + '/manage.html', null, null, null)
            bindProps('#dropdown-view-profile', res.profileUrl, null, null, null)
            bindProps('#drafts-link', '/users/' + res.id + '/drafts.html', null, null, null)

            if (res.isAdmin) {
                // Construct backwards so the #after call places elements in the correct order
                const firstUserAction = document.querySelector('#first-user-action')
                const adminConsoleItem = document.createElement('li')
                const adminConsoleLink = createLink('/dzone/staff/index.html', 'Admin Console')
                adminConsoleItem.appendChild(adminConsoleLink)
                firstUserAction.after(adminConsoleItem)

                const moderationItem = document.createElement('li')
                const moderationLink = createLink('/moderation/list.html', 'Moderation')
                moderationItem.appendChild(moderationLink)
                firstUserAction.after(moderationItem)

	            const bountyModerationItem = document.createElement('li')
	            const bountyModerationLink = createLink('/moderation/bounties', 'Bounty Moderation')
	            bountyModerationItem.appendChild(bountyModerationLink)
	            firstUserAction.after(bountyModerationItem)
            }

            authenticated.isAuthenticated = res.authenticated;
            authenticated.isAdmin = res.isAdmin;

            authenticatedBlock.classList.add('shown')
        }
    }).catch(function (result) {
        console.error(result)
})

/**
 * Binds different properties to the selected element.
 *
 * @param selector - Selector to select the element
 * @param href - href attribute value
 * @param src - src attribute value
 * @param innerHTML - innerHTML property value
 * @param innerText - innerText property value
 */
function bindProps(selector, href, src, innerHTML, innerText) {
    const element = document.querySelector(selector)
    if (element) {
        if (href) element.href = href
        if (src) element.src = src
        if (innerHTML) element.innerHTML = innerHTML
        if (innerText) element.innerText = innerText
    }
}

/**
 * Creates a new link element.
 *
 * @param href - href attribute value
 * @param innerText - innerText property value
 * @returns {HTMLAnchorElement} The generated link element
 */
function createLink(href, innerText) {
    const link = document.createElement('a')
    link.href = href
    link.innerText = innerText

    return link
}
</script><script>
const userHeader = document.querySelector('#user-header')
const userDropdown = document.querySelector('#user-dropdown')
const postDropdown = document.querySelector('#post-button')
const postMenu = document.querySelector('#post-menu')

let userDropdownOpen = false
let postDropdownOpen = false

document.addEventListener('click', function(event) {
    if (postDropdown && postDropdown.contains(event.target)) {
        setUserDropdown(false)
        setPostDropdown(!postDropdownOpen)
    } else if (userHeader && userHeader.contains(event.target)) {
        setPostDropdown(false)
        setUserDropdown(!userDropdownOpen)
    } else {
        setUserDropdown(false)
        setPostDropdown(false)
    }
})

function setUserDropdown(value) {
    userDropdownOpen = value
    if (userDropdownOpen) {
        if (userDropdown) {
            userDropdown.classList.add('open')
        }
    } else {
        if (userDropdown) {
            userDropdown.classList.remove('open')
        }
    }
}

function setPostDropdown(value) {
    postDropdownOpen = value
    if (postDropdownOpen) {
        if (postMenu) {
            postMenu.classList.add('open')
        }
    } else {
        if (postMenu) {
            postMenu.classList.remove('open')
        }
    }
}
</script><script>
	document.addEventListener("alpine:init", () => {
		Alpine.store('global', {
			executeHttp(path, body, method) {
				const options = {
					method: method,
					headers: {
						[csrf.header]: csrf.token
					}
				};

				if (method !== 'GET') {
					options.body = JSON.stringify(body);
					options.headers = {
						...options.headers,
						'Content-Type': 'application/json; charset=UTF-8'
					};
				}

				return new Promise((resolve, reject) => {
					fetch(path, options)
						.then(res => {
							if (!res.ok) {
								reject(res);
							} else {
								resolve(res);
							}
						})
						.catch(err => reject(err));
				});
			},
			getFromService(path) {
				return this.executeHttp(path, null, 'GET');
			},
			postToService(path, body = {}) {
				return this.executeHttp(path, body, 'POST');
			},
			putToService(path, body = {}) {
				return this.executeHttp(path, body, 'PUT');
			}
		});
	});
</script>
<link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/colors.css">
<link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/article/styles.css">




<div id="body-container">
	<script type="text/javascript" async>
(function() {
    let announcementPosition = 1;
    let minAnnouncementPosition = -1;
    let maxAnnouncementPosition = -1;

    const announcementPrevBtn = document.querySelector('#announcement-previous');
    const announcementNextBtn = document.querySelector('#announcement-next');

    function withAnnouncements(callback) {
        const announcements = document.querySelectorAll('#announcement-container .announcement');
        for (let announcement of announcements) {
            callback(announcement);
        }
    }

    function initAnnouncementVars() {
        document.querySelector(':root').style.setProperty('--mobile-announcement-separator-width', '1px');
        withAnnouncements(function(announcement) {
            const pos = parseInt(announcement.getAttribute('data-position'));
            minAnnouncementPosition = minAnnouncementPosition === -1 ? pos : Math.min(minAnnouncementPosition, pos);
            maxAnnouncementPosition = maxAnnouncementPosition === -1 ? pos : Math.max(maxAnnouncementPosition, pos);
        });

        if (document.querySelector('.announcementBarContainer')) {
            document.querySelector(':root').style.setProperty('--body-top-padding', '0');
        }

        if (maxAnnouncementPosition <= 0) {
            document.querySelector(':root').style.setProperty('--body-top-padding', '0');
        }

        sizeToFullWhenOneEntryOnMobile();
    }

    function setAnnouncementPosition(position) {
        if (window.outerWidth >= 890) {
            return; // we do not need to change the position, since we can display everything on desktop.
        }

        // Make the announcement cyclical
        if (minAnnouncementPosition !== -1 && maxAnnouncementPosition !== -1) {
            if (position > maxAnnouncementPosition) {
                position = minAnnouncementPosition; // overflow to the first announcement
            } else if (position < minAnnouncementPosition) {
                position = maxAnnouncementPosition; // underflow to the last announcement
            }
            announcementPosition = position;
        }

        const shownAnnouncements = [];

        let reverseFlex = false; // should only be true when the first and last items are showing

        // Now that the position is valid, apply the transforms
        withAnnouncements(function(announcement) {
            const pos = parseInt(announcement.getAttribute('data-position'));
            const isWrapped = position === maxAnnouncementPosition && pos === minAnnouncementPosition; // showing first + last at same time
            const doesNextQualify = window.outerWidth >= 500 && (pos === position + 1 || isWrapped);

            if (pos === position || doesNextQualify) {
                shownAnnouncements.push(announcement);
            } else {
                announcement.style.display = 'none';
            }

            announcement.style.opacity = 0.0;

            if (isWrapped) {
                reverseFlex = true;
            }
        });

        for (let announcement of shownAnnouncements) {
            announcement.style.display = 'flex';
            announcement.style.opacity = 1.0;
        }

        const announcementContainer = document.querySelector('#announcement-container');
        if (announcementContainer) {
            announcementContainer.style.flexDirection = reverseFlex ? 'row-reverse' : 'row';
        }
    }

    function resetAnnouncements() {
        announcementPosition = 1;
        const announcementContainer = document.querySelector('#announcement-container');
        if (announcementContainer) {
            announcementContainer.style.flexDirection = 'row';
        }
        withAnnouncements(function(announcement) {
            announcement.style.opacity = 1.0;
            announcement.style.display = 'flex';
        });
    }

    function sizeToFullWhenOneEntryOnMobile() {
        if (maxAnnouncementPosition <= 2 && announcementPrevBtn && announcementNextBtn) {
            announcementPrevBtn.style.display = maxAnnouncementPosition === 2 && window.outerWidth < 500 ? 'flex' : 'none';
            announcementNextBtn.style.display = maxAnnouncementPosition === 2 && window.outerWidth < 500 ? 'flex' : 'none';
        }
        if (maxAnnouncementPosition === 1 && window.outerWidth >= 500 && window.outerWidth < 890) {
            document.querySelector(':root').style.setProperty('--mobile-announcement-separator-width', '0');
            document.querySelector('#announcement-container .announcement').style.maxWidth = '100%';
        }
    }

    function resetAnnouncementsOnResize() {
        announcementPosition = 1; // we want to reset the announcement position every resize
        if (window.outerWidth >= 890) { // 4 announcements can be shown (215px * 4) + separator padding
            resetAnnouncements();
        } else { // if we're still on mobile, set the position to normalize things after resize
            setAnnouncementPosition(announcementPosition);
            sizeToFullWhenOneEntryOnMobile();
        }
    }

    window.addEventListener('resize', resetAnnouncementsOnResize);

    initAnnouncementVars();
    setAnnouncementPosition(announcementPosition); // sets the min & max positions as well as initializes transforms

    if (announcementPrevBtn) {
        announcementPrevBtn.onclick = function() {
            setAnnouncementPosition(announcementPosition - 1);
        };
    }

    if (announcementNextBtn) {
        announcementNextBtn.onclick = function() {
            setAnnouncementPosition(announcementPosition + 1);
        };
    }
})();	</script>
  <div id="ftl-article" class="trending-article-body">
      <div class="trending-sidebar">
        <div class="trending">
          <h3>Related</h3>
          <div class="trending-separator"></div>
          <ul>
              <li class="item">
                <a href="/articles/event-sourcing-explained-building-robust-systems" class="related-link">Event Sourcing Explained: Building Robust Systems With Immutable Event Logs</a>
              </li>
              <li class="item">
                <a href="/articles/event-sourcing-in-net-core-a-gentle-introduction" class="related-link">Event Sourcing in .NET Core: A Gentle Introduction</a>
              </li>
              <li class="item">
                <a href="/articles/multi-channel-notification-patterns-security-events" class="related-link">Multi-Channel Notification Patterns for Security-Critical Events</a>
              </li>
              <li class="item">
                <a href="/articles/synergy-of-event-driven-architectures-with-mcp" class="related-link">Synergy of Event-Driven Architectures With the Model Context Protocol</a>
              </li>
          </ul>
        </div>
      </div>
    <div class="container-fluid body trending-article-fluid">
      <div class="row">
        <div class="col-md-12">
          <div class="articles-wrap">
                <div class="ad-container">
                  <div id="div-gpt-ad-1435246566686-0" class="ads-billboard-article" data-gpt-slot="top"></div>
                </div>


            <div class="article-stream widget-top-border">
                <div class="content-right-images">
                  <div id="div-gpt-ad-1435246566686-2" class="sidebar-ad" data-gpt-desktop="true" data-gpt-slot="sidebar1"></div>
                    <div class="trending-separator"></div>
                    <div class="trending">
                      <h3>Trending</h3>
                      <ul>
                          <li class="item">
                            <a href="/articles/troubleshooting-cors-node-angular" class="trending-link" target="_self">CORS Misconfigurations: The Simple API Header That Took Down Our Frontend</a>
                          </li>
                          <li class="item">
                            <a href="/articles/smarter-IoT-systems-edge-computing-AI" class="trending-link" target="_self">Smarter IoT Systems With Edge Computing and AI</a>
                          </li>
                          <li class="item">
                            <a href="/articles/secure-devops-in-serverless-architecture" class="trending-link" target="_self">Secure DevOps in Serverless Architecture</a>
                          </li>
                          <li class="item">
                            <a href="/articles/docker-desktop-improves-dev-workflows-observability" class="trending-link" target="_self">How Docker Desktop Enhances Developer Workflows and Observability</a>
                          </li>
                      </ul>
                    </div>
                </div>
                <script type="application/ld+json">
                  {
                    "@context": "https://schema.org",
                    "@type": "Article",
                    "headline": "Event Sourcing 101: When to Use and How to Avoid Pitfalls",
                    "author": [{"image":{"@type":"ImageObject","caption":"Vladyslav Rybnikov","url":"https://secure.gravatar.com/avatar/9cb231f94066f8f8d7c9f68f25ac9bd5?d=identicon&r=PG"},"@type":"Person","worksFor":{"@type":"Organization","name":"Innovecs"},"name":"Vladyslav Rybnikov","url":"https://dzone.com/users/5238181/vrybnikov.html"}],
                    "audience": "software developers",
                    "keywords": "",
                    "timeRequired": "PT7M",
                    "commentCount": 1,
                    "wordCount": "1730",
                    "accessMode": "textual, visual",
                    "datePublished": "2025-03-14T00:00:00Z",
                    
                    "articleSection": "",
                    "publisher": {
                      "@type": "Organization",
                      "name": "DZone",
                      "url": "https://dzone.com",
                      "logo": {
                        "@type": "ImageObject",
                        "url": "https://dzone.com/themes/dz20/images/dz_logo_2021_cropped.png"
                      }
                    },
                    "articleBody": "Recently, I delivered a lecture to my colleagues on event sourcing, and I realized that this introductory information could be valuable to a broader audience. This article is useful for those interested in the concept of event sourcing and who want to decide if it's a good fit for their projects while avoiding common pitfalls. So, let's dive in. Event sourcing is an approach where, instead of storing the current state of the system, all changes are saved as events, which become the main data source. The approach gained popularity around 2005 after Martin Fowler’s article on the topic. The main idea is that instead of storing and updating the application’s state, you save the events that describe changes. Events act as the core source of information. This differs from the traditional approach, where the current state is saved and updated with each change. In event sourcing, each change is logged as a new event instead of modifying an existing record. For example, in an app where users can edit their profiles, the traditional approach uses an \"Update\" command to modify the existing database record. With event sourcing, instead of \"Update,\" we use \"Insert,\" adding a new entry to an event log that records the change. Events include a user identifier (StreamID), the event name, version, and new data, such as a new username. This creates an \"append-only\" log, an immutable record where each change is a separate event. This method preserves the full change history, simplifying auditing, recovery, and data analysis. Event Sourcing Pros and Cons Below are some benefits of event sourcing: Observability. You can track all changes, create an audit log, and restore data states at any point in time.System decomposition. Supports asynchronous interactions between system components and microservices.Enhanced fault tolerance. Reduces data loss risk, especially when there are multiple Event Store replicas.Easy data migration. Data can be easily transferred between databases by replaying events. Challenges Complex implementation and maintenance. Event sourcing isn’t always the best fit.Potential overengineering. It’s not suitable for every project. Before implementing event sourcing, it's essential to answer these questions: 1. Can events be considered part of my app's domain? Determine if you plan to use events for asynchronous tasks, like sending emails, or for breaking down the system into microservices that interact through events. 2. Can events help me develop and maintain my app? Consider whether event storage will support your development and maintenance needs. 3. Do I need to know about every change in my app? Evaluate if you need to track every change or if there are storage limitations for tracking all operations. With these questions in mind, you can decide if event sourcing is suitable for your application. For example, in financial apps where account balances frequently change, events can efficiently reflect these adjustments. Each balance change links to events like deposits or withdrawals. This approach enables you to recreate the account's state at any given time by applying the sequence of events, each with a specific type and logic. Here are some examples of the approach across different domains: FinTech State example: Account balanceEvents: Deposit, withdrawal, financial month start, account creationProjections: Transaction logs, account history Supply Chain State example: Shipment statusEvents: Delivery requested, accepted by carrier, status updatesProjections: Delivery requests, carrier pending deliveries Healthcare State example: Patient’s medical recordEvents: Doctor visits, medical examsProjections: Medical history Event Sourcing Building Blocks To build an event-sourcing system, focus on these key components: 1. Event Store A storage solution for all events in the system, grouped into streams with unique IDs and ordered versions. For example, EventStoreDB is a popular choice. The event store organizes events into streams, each with an ID and a chronological list of events for a particular entity. 2. Aggregates A Domain-Driven Design (DDD) concept that groups multiple objects into a whole, each with a unique ID. For a financial app, an aggregate could be an account that ties together balances and cards, while transactions might form a separate aggregate. The root of an aggregate is the access point for managing changes. 3. Events Each event has a unique ID, version, and type, and is immutable. For example, a transaction event can be represented in JSON with fields like version, name (e.g., “deposit”), amount, currency, and other details. 4. Event Stream An ordered sequence of events, each with a version in the stream. There are different ways to organize streams: Single stream per aggregate. Each stream is tied to a specific aggregate, like a “Balance” stream for account ID 1 with events only for that balance.Multiple streams for one aggregate. You can create separate streams for different periods or categories, such as monthly balance streams.Global event stream. Contains all events for all aggregates, ordered by time. 5. Projections Also called read models, query models, or view models, projections organize events into user-friendly formats, like transaction histories or account statements. They can aggregate or group events to simplify data access. 6. Snapshots Optional state saves for aggregates, used to optimize state restoration. Snapshots are not required but can improve performance when replaying event histories. Building Aggregate States To build an aggregate state from events in a stream, follow these steps: 1. Replaying StateFrom Events To recreate the account's state, define a class like 'AccountBoundState' with fields such as 'Amount', 'Currency', and other properties. The class includes an 'Apply' method that takes an event and adjusts the state based on the event type: For a deposit event, the 'Apply' method increases 'Amount' by the deposit amount.For a withdrawal event, the 'Apply' method decreases 'Amount' by the corresponding amount. This approach allows you to restore the account's state at any given version by sequentially applying each event up to the desired version. 2. Using Projections Projections simplify data access by creating read-only models for efficient querying. Projections can be tailored for individual events or aggregated for groups of events. Examples include: Transaction projection. Stores a list of all account transactions.Balance projection. Reflects the current account balance. Optimizing With Snapshots When the number of events grows very large (millions or more), replaying all events becomes inefficient. Snapshots help by saving the aggregate's state at specific versions, so you can start from the latest snapshot rather than from the beginning. C# var snapshot = snapshots.LastOrDefault(); state.LoadFromSnapshot(snapshot); foreach (var domainEvent in orderedDomainEvents.Where(x =&gt; x.Version &gt; snapshot.Version)) { state.Apply(domainEvent); } Snapshots can be stored in a separate stream, like balance-1-snapshot.To restore the state to a certain version, retrieve the latest snapshot and apply all events with versions higher than the snapshot's version. Snapshot Creation Strategy Decide how often to create snapshots based on system usage: Every N event (e.g., every 100 events),At specific time intervals (e.g., at the start of each new month),A combination of both approaches. Main Challenges in Event Sourcing and Their Solutions 1. Concurrency Updates In distributed systems with multiple microservices and parallel access to data, concurrency updates and distributed transaction issues arise. The primary approaches to handling concurrency updates include: Pessimistic Concurrency Control This approach locks the resource (e.g., a database record) during an operation, so other processes have to wait until the lock is released. It can be implemented using distributed locks, such as with Redis or PostgreSQL. Optimistic Concurrency Control Instead of locking the resource, this approach relies on version checking. The object state holds a version, and during an update, it verifies that the version in the database matches the expected version. If not, the operation retries: the state is read again, validated, and updated. In event sourcing, rather than a mutable state, there’s an event stream (append-only log). This avoids concurrency update issues since new events are only appended to the end of logs. If each new event needs to depend on the previous one, optimistic version control is used, naturally supported by many event-sourcing implementations. If the dependency between events is unimportant (e.g., adding items to an order in an online store), events can be added without version checking. 2. Distributed Transactions In distributed systems, it's crucial to ensure that changes across various data stores or services are consistent. Solutions include: 2-Phase Commit Suitable for transactions across multiple systems, though not supported by all data stores. This process involves two stages: preparation (all participants confirm readiness) and commit, provided all are ready. Outbox Pattern The idea here is to write events to an \"outbox\" (a special messages table) in parallel with the database write. Then, a dedicated service asynchronously sends these messages to a queue, ensuring reliable delivery. Transactional Saga Pattern Manages distributed transactions through orchestration (centralized sequence of steps) and choreography (each step decides the next based on the current transaction state). 3. Projection Synchronization When a system uses projections for data reads, it’s essential to ensure their consistency and synchronization with the main event store. This can be achieved with: Asynchronous Updates Projections are updated asynchronously as new events are added. A message queue can be used so that each projection receives updates automatically. Eventual Consistency The system allows a small delay between event recording and projection updates. Ensuring all required events are processed is key. These approaches allow for flexibility in meeting specific system requirements, maintaining consistency, and high performance in distributed environments. 4. Optimizing Read Process and State Computation Event sourcing involves replaying the state from all events, which can be resource-intensive for large streams. Key optimization techniques include: Snapshotting Creating saved snapshots of an object's state at specific versions. For example, a snapshot of an account's state can be created every 100 events. This way, when replaying, the system starts from the latest snapshot and only applies new events, reducing the number of operations required to restore the current state. Projections Representing events in a convenient format for queries, such as a transaction history or current account balance. Projections can be updated in real time or periodically, depending on the specific use case. CQRS (Command Query Responsibility Segregation) This approach separates write operations (event creation) from read operations (queries) into different data models. Writing is done via event sourcing, while reading is done through pre-built projections, which optimizes system performance. Conclusion So, while event sourcing presents challenges such as handling distributed transactions and concurrency control, these can be effectively managed through established patterns and best practices. By thoughtfully implementing this concept, teams can build applications that are more resilient, maintainable, and scalable, making it a valuable asset in modern software development.",
                    "mainEntityOfPage": {
                      "@type": "WebPage",
                      "@id": "https://dzone.com/articles/event-sourcing-guide-when-to-use-avoid-pitfalls"
                    },
                    "image": {
                      "@type": "ImageObject",
                      "url": "https://dz2cdn1.dzone.com/storage/article-thumb/18278455-thumb.jpg"
                    }
                  }
                </script>

	<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "DZone",
            "item": "https://dzone.com"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Software Design and Architecture",
            "item": "https://dzone.com/software-design-and-architecture"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "Performance",
            "item": "https://dzone.com/performance"
          },
          {
            "@type": "ListItem",
            "position": 4,
            "name": "Event Sourcing 101: When to Use and How to Avoid Pitfalls",
            "item": "https://dzone.com/articles/event-sourcing-guide-when-to-use-avoid-pitfalls"
          }
      ]
    }

	</script>

              <article>
                <div class="content">
                  <div class="header">
	<ol class="breadcrumb">
				<li class="server"><a href="https://dzone.com">DZone</a></li>
				<li class="server"><a href="https://dzone.com/software-design-and-architecture">Software Design and Architecture</a></li>
				<li class="server"><a href="https://dzone.com/performance">Performance</a></li>
				<li class="active server">Event Sourcing 101: When to Use and How to Avoid Pitfalls</li>
	</ol>


                    <div class="header-title">
                      <div class="title">
                        <h1 class="article-title">Event Sourcing 101: When to Use and How to Avoid Pitfalls</h1>
                      </div>

                      <div class="subhead">
                        <h3>Learn the basics of event sourcing and its benefits, challenges, and practical use cases to decide if it's the right fit for your software project.</h3>
                      </div>

                      <div class="publish-meta">
                        By<span style="user-select: none;">&nbsp;</span>
  <div class="article-author-meta">
    <img src="https://dz2cdn1.dzone.com/thumbnail?fid=18027906&w=80" class="avatar" alt="Vladyslav Rybnikov user avatar" width="40">
    <div class="author-info">
      <span class="author-name">
        <a href="/users/5238181/vrybnikov.html" rel="nofollow">Vladyslav Rybnikov</a>
      </span>
    </div>



    &middot;
  </div>
                        <span class="author-date">
                          Mar. 14, 25
                        </span>
                        &middot;
                        <span>Analysis</span>
                      </div>
                    </div>
                  </div>

                  <div class="author-n-useraction">
                    <div class="like action" x-data="engagementModal(articleId)">
                      <span id="activity-like-icon" class="dz-like icon-thumbs-up" x-on:click="updateStore()"></span>
                      <span class="action-label like-text" x-on:click="open()" x-cloak>
                        <span>Likes</span>
                        <span id="activity-like-counter" class="like-count">(5)</span>
                      </span>
<template x-teleport="body">
	<div class="engagement-overlay" x-show="$store.article.engagement.open && nodeId === $store.article.id" x-on:keyup.escape.window="close()">
		<div class="engagement-modal">
			<div class="inner" x-on:click.outside="close()">
				<div class="header">
					<div class="title">Likes</div>
					<button class="close" x-on:click="close()"></button>
				</div>
				<div class="content">
					<div x-show="$store.article.engagement.initializing" class="loading-screen">
						<i class="icon icon-spin3 anim-spin"></i>
					</div>
					<div x-show="!$store.article.engagement.initializing">
						<template x-for="user in $store.article.engagement.users" :key="user.id">
							<div class="media">
								<div class="media-left">
									<img class="avatar"
									     x-bind:src="user.profile.profileImage"
									     loading="lazy"
									     width="50"
									     height="50"
									>
								</div>
								<div class="media-right">
									<a x-bind:href="user.computed.url" x-html="user.profile.name"></a>
									<div x-show="formatJobData(user)" x-html="formatJobData(user)"></div>
								</div>
							</div>
						</template>
					</div>
					<div x-show="isDataUnavailable()" class="center-screen">
						<div x-show="!$store.article.engagement.unauthorized">
							<div>There are no likes...yet! &#128064;</div>
							<div>Be the first to like this post!</div>
						</div>
						<div x-show="$store.article.engagement.unauthorized">
							<div>It looks like you're not logged in.</div>
							<div><a href="/users/login.html">Sign in</a> to see who liked this post!</div>
						</div>
					</div>
					<div x-show="isFooterShowing()">
						<div class="footer">
							<button class="btn btn-primary" x-on:click="fetchEngagements()"
							        x-bind:disabled="$store.article.engagement.loading"
							>
								Load More
								<i x-show="$store.article.engagement.loading" class="icon icon-spin3 anim-spin"></i>
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</template>                    </div>

                    <div class="action comment-action">
                      <span class="comment">
                        <i class="icon-comment"></i>
                        <span class="action-label">Comment</span>
                        <span id="activity-comment-counter" class="comment-count"></span>
                      </span>
                    </div>

                    <div class="save action">
                      <div id="activity-save-icon" class="save icon-star-empty">
                        <span id="activity-save-text" class="action-label">Save</span>
                      </div>
                    </div>

                    <div class="tweet action">
                      <a id="tweet-link" href="" class="title" target="_blank">
                        <span><i class="icon-twitter"></i></span>
                        <span class="action-label">Tweet</span>
                      </a>
                    </div>

                    <div class="linkedin action">
                      <a id="linkedin-link" href="https://www.linkedin.com/sharing/share-offsite/?url=https://dzone.com/articles/event-sourcing-guide-when-to-use-avoid-pitfalls" class="title" target="_blank">
                        <span><i class="icon-linkedin-1"></i></span>
                        <span class="action-label">Share</span>
                      </a>
                    </div>

                    <div class="right-most">
                      <div id="activity-view-container" class="article-views action">
                        <i class="icon-eye"></i>
                        <span class="action-label view-count">5.4K Views</span>
                      </div>
                    </div>
                  </div>

                      <div class="signin-prompt">
                        <p>Join the DZone community and get the full member experience.</p>
                        <a id="article-signin-prompt" href="/static/registration.html">Join For Free</a>
                      </div>
                      <div class="arrow-down"></div>

                    <div id="top-bumper-container"></div>

                  <div>
                    <div class="content-html"><p dir="ltr">Recently, I delivered a lecture to my colleagues on event sourcing, and I realized that this introductory information could be valuable to a broader audience.</p>
<p dir="ltr">This article is useful for those interested in the concept of event sourcing and who want to decide if it's a good fit for their projects while avoiding common pitfalls. So, let's dive in.</p>
<p dir="ltr"><a href="https://dzone.com/articles/event-sourcing-explained-building-robust-systems">Event sourcing</a> is an approach where, instead of storing the current state of the system, all changes are saved as events, which become the main data source. The approach gained popularity around 2005 after Martin Fowler’s article on the topic.</p>
<p dir="ltr"><span class="fr-img-caption fr-fic fr-dib" style="width: 600px;"><span class="fr-img-wrap"><img data-image="true" data-new="false" data-sizeformatted="405.5 kB" data-mimetype="image/jpeg" data-creationdate="1730981447357" data-creationdateformatted="11/07/2024 12:10 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027919-цитата-martin-fowler-1.jpg" data-modificationdate="null" data-size="405501" data-name="цитата-martin-fowler-1.jpg" data-id="18027919" style="width: 600px;" data-src="https://dz2cdn1.dzone.com/storage/temp/18027919-цитата-martin-fowler-1.jpg" alt="A quote by Martin Fowler on event sourcing" class="lazyload"></span></span></p>
<figcaption class="fr-inner" contenteditable="true">
 <br>
</figcaption>
<p dir="ltr">The main idea is that instead of storing and updating the application’s state, you save the events that describe changes. Events act as the core source of information. This differs from the traditional approach, where the current state is saved and updated with each change. In event sourcing, each change is logged as a new event instead of modifying an existing record.</p>
<p dir="ltr">For example, in an app where users can edit their profiles, the traditional approach uses an "Update" command to modify the existing database record. With event sourcing, instead of "Update," we use "Insert," adding a new entry to an event log that records the change.</p>
<p dir="ltr"><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="231.4 kB" data-mimetype="image/png" data-creationdate="1730981538227" data-creationdateformatted="11/07/2024 12:12 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027920-screenshot-2024-11-01-at-142034.png" data-modificationdate="null" data-size="231411" data-name="screenshot-2024-11-01-at-142034.png" data-id="18027920" data-src="https://dz2cdn1.dzone.com/storage/temp/18027920-screenshot-2024-11-01-at-142034.png" alt="Instead of &quot;Update,&quot; we use &quot;Insert&quot;"><br></p>
<p dir="ltr">Events include a user identifier (StreamID), the event name, version, and new data, such as a new username. This creates an "append-only" log, an immutable record where each change is a separate event.</p>
<p dir="ltr">This method preserves the full change history, simplifying auditing, recovery, and data analysis.</p>
<h2 dir="ltr">Event Sourcing Pros and Cons</h2>
<p dir="ltr">Below are some benefits of event sourcing:</p>
<ol>
 <li dir="ltr"><strong>Observability</strong>.<strong>&nbsp;</strong>You can track all changes, create an audit log, and restore data states at any point in time.</li>
 <li dir="ltr"><strong>System decomposition</strong>. Supports asynchronous interactions between system components and microservices.</li>
 <li dir="ltr"><strong>Enhanced fault tolerance</strong>. Reduces data loss risk, especially when there are multiple Event Store replicas.</li>
 <li dir="ltr"><strong>Easy data migration</strong>. Data can be easily transferred between databases by replaying events.</li>
</ol>
<p><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="447.4 kB" data-mimetype="image/png" data-creationdate="1730981730477" data-creationdateformatted="11/07/2024 12:15 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027921-meme-event-sourcing-2-1.png" data-modificationdate="null" data-size="447385" data-name="meme-event-sourcing-2-1.png" data-id="18027921" data-src="https://dz2cdn1.dzone.com/storage/temp/18027921-meme-event-sourcing-2-1.png" alt="Photo of a guy challenging people to change his mind about not needing event sourcing"><br></p>
<h3 dir="ltr"><strong>Challenges</strong></h3>
<ol>
 <li dir="ltr"><strong>Complex implementation and maintenance</strong>. Event sourcing isn’t always the best fit.</li>
 <li dir="ltr"><strong>Potential overengineering</strong>. It’s not suitable for every project.</li>
</ol>
<p dir="ltr">Before implementing event sourcing, it's essential to answer these questions:</p>
<p dir="ltr">1.<strong>&nbsp;Can events be considered&nbsp;</strong><strong>part of my app's domain</strong>?</p>
<p dir="ltr">Determine if you plan to use events for asynchronous tasks, like sending emails, or for breaking down the system into microservices that interact through events.</p>
<p dir="ltr">2. <strong>Can events help me develop and maintain my app</strong>?</p>
<p dir="ltr">Consider whether event storage will support your development and maintenance needs.</p>
<p dir="ltr">3. <strong>Do I need to know about every change in my app</strong>?</p>
<p dir="ltr">Evaluate if you need to track every change or if there are storage limitations for tracking all operations.</p>
<p dir="ltr">With these questions in mind, you can decide if event sourcing is suitable for your application.</p>
<p dir="ltr">For example, in financial apps where account balances frequently change, events can efficiently reflect these adjustments. Each balance change links to events like deposits or withdrawals. This approach enables you to recreate the account's state at any given time by applying the sequence of events, each with a specific type and logic.<br><br><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="14.0 kB" data-mimetype="image/png" data-creationdate="1730982353951" data-creationdateformatted="11/07/2024 12:25 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027928-tech-scheme-2.png" data-modificationdate="null" data-size="13952" data-name="tech-scheme-2.png" data-id="18027928" data-src="https://dz2cdn1.dzone.com/storage/temp/18027928-tech-scheme-2.png" alt="Events can efficiently reflect adjustments in financial apps"><br></p>
<p dir="ltr">Here are some examples of the approach across different domains:</p>
<h3 dir="ltr"><strong>FinTech</strong></h3>
<ul>
 <li dir="ltr"><strong>State example</strong>: Account balance</li>
 <li dir="ltr"><strong>Events</strong>: Deposit, withdrawal, financial month start, account creation</li>
 <li dir="ltr"><strong>Projections</strong>: Transaction logs, account history</li>
</ul>
<h3 dir="ltr"><strong>Supply Chain</strong></h3>
<ul>
 <li dir="ltr"><strong>State example</strong>: Shipment status</li>
 <li dir="ltr"><strong>Events</strong>: Delivery requested, accepted by carrier, status updates</li>
 <li dir="ltr"><strong>Projections</strong>: Delivery requests, carrier pending deliveries</li>
</ul>
<h3 dir="ltr"><strong>Healthcare</strong></h3>
<ul>
 <li dir="ltr"><strong>State example</strong>: Patient’s medical record</li>
 <li dir="ltr"><strong>Events</strong>: Doctor visits, medical exams</li>
 <li dir="ltr"><strong>Projections</strong>: Medical history</li>
</ul>
<h2 dir="ltr">Event Sourcing Building Blocks</h2>
<p dir="ltr">To build an event-sourcing system, focus on these key components:</p>
<h3><strong>1. Event Store</strong></h3>
<p>A storage solution for all events in the system, grouped into streams with unique IDs and ordered versions. For example, EventStoreDB is a popular choice. The event store organizes events into streams, each with an ID and a chronological list of events for a particular entity.</p>
<p><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="61.6 kB" data-mimetype="image/png" data-creationdate="1730982415790" data-creationdateformatted="11/07/2024 12:26 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027929-tech-scheme-3.png" data-modificationdate="null" data-size="61609" data-name="tech-scheme-3.png" data-id="18027929" data-src="https://dz2cdn1.dzone.com/storage/temp/18027929-tech-scheme-3.png" alt="An event source"><br></p>
<h3 dir="ltr"><strong>2.</strong> <strong>Aggregates</strong></h3>
<p dir="ltr">A <a href="https://dzone.com/articles/domain-driven-design-why-do-companies-need-this-ap">Domain-Driven Design (DDD) concept</a> that groups multiple objects into a whole, each with a unique ID. For a financial app, an aggregate could be an account that ties together balances and cards, while transactions might form a separate aggregate. The root of an aggregate is the access point for managing changes.</p>
<p dir="ltr"><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="64.6 kB" data-mimetype="image/png" data-creationdate="1730982485699" data-creationdateformatted="11/07/2024 12:28 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027930-tech-scheme-4.png" data-modificationdate="null" data-size="64558" data-name="tech-scheme-4.png" data-id="18027930" data-src="https://dz2cdn1.dzone.com/storage/temp/18027930-tech-scheme-4.png" alt="Account aggregate boundary"><br></p>
<h3 dir="ltr"><strong>3. Events</strong></h3>
<p dir="ltr">Each event has a unique ID, version, and type, and is immutable. For example, a transaction event can be represented in JSON with fields like version, name (e.g., “deposit”), amount, currency, and other details.</p>
<h3 dir="ltr"><strong>4. Event Stream</strong></h3>
<p dir="ltr">An ordered sequence of events, each with a version in the stream. There are different ways to organize streams:</p>
<ul>
 <li dir="ltr"><strong>Single stream per aggregate</strong>. Each stream is tied to a specific aggregate, like a “Balance” stream for account ID 1 with events only for that balance.</li>
 <li dir="ltr"><strong>Multiple streams for one aggregate</strong>. You can create separate streams for different periods or categories, such as monthly balance streams.</li>
 <li dir="ltr"><strong>Global event stream</strong>. Contains all events for all aggregates, ordered by time.</li>
</ul>
<h3 dir="ltr"><strong>5. Projections</strong></h3>
<p dir="ltr">Also called read models, query models, or view models, projections organize events into user-friendly formats, like transaction histories or account statements. They can aggregate or group events to simplify data access.</p>
<h3 dir="ltr"><strong>6. Snapshots</strong></h3>
<p dir="ltr">Optional state saves for aggregates, used to optimize state restoration. Snapshots are not required but can improve performance when replaying event histories.</p>
<h2 dir="ltr">Building Aggregate States&nbsp;</h2>
<p dir="ltr">To build an aggregate state from events in a stream, follow these steps:</p>
<h3 dir="ltr"><strong>1. Replaying StateFrom Events</strong></h3>
<p dir="ltr">To recreate the account's state, define a class like 'AccountBoundState' with fields such as 'Amount', 'Currency', and other properties. The class includes an 'Apply' method that takes an event and adjusts the state based on the event type:</p>
<ul>
 <li dir="ltr">For a deposit event, the 'Apply' method increases 'Amount' by the deposit amount.</li>
 <li dir="ltr">For a withdrawal event, the 'Apply' method decreases 'Amount' by the corresponding amount.</li>
</ul>
<p dir="ltr"><img style="width: 650px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="247.4 kB" data-mimetype="image/png" data-creationdate="1730982673157" data-creationdateformatted="11/07/2024 12:31 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027935-screenshot-2024-10-18-at-133144.png" data-modificationdate="null" data-size="247388" data-name="screenshot-2024-10-18-at-133144.png" data-id="18027935" data-src="https://dz2cdn1.dzone.com/storage/temp/18027935-screenshot-2024-10-18-at-133144.png" alt="Replaying StateFrom events"><br></p>
<p dir="ltr">This approach allows you to restore the account's state at any given version by sequentially applying each event up to the desired version.</p>
<h3 dir="ltr"><strong>2. Using Projections</strong></h3>
<p dir="ltr">Projections simplify data access by creating read-only models for efficient querying. Projections can be tailored for individual events or aggregated for groups of events. Examples include:</p>
<ul>
 <li dir="ltr"><strong>Transaction projection</strong>. Stores a list of all account transactions.</li>
 <li dir="ltr"><strong>Balance projection</strong>. Reflects the current account balance.</li>
</ul>
<p dir="ltr"><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="71.0 kB" data-mimetype="image/png" data-creationdate="1730982829209" data-creationdateformatted="11/07/2024 12:33 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027936-tech-scheme-5.png" data-modificationdate="null" data-size="71027" data-name="tech-scheme-5.png" data-id="18027936" data-src="https://dz2cdn1.dzone.com/storage/temp/18027936-tech-scheme-5.png" alt="Using projections"></p>
<h2 dir="ltr"><br><strong>Optimizing With Snapshots</strong></h2>
<p dir="ltr">When the number of events grows very large (millions or more), replaying all events becomes inefficient. Snapshots help by saving the aggregate's state at specific versions, so you can start from the latest snapshot rather than from the beginning.</p>
<p><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="886.3 kB" data-mimetype="image/png" data-creationdate="1730982973226" data-creationdateformatted="11/07/2024 12:36 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027940-meme-event-sourcing-1.png" data-modificationdate="null" data-size="886322" data-name="meme-event-sourcing-1.png" data-id="18027940" data-src="https://dz2cdn1.dzone.com/storage/temp/18027940-meme-event-sourcing-1.png" alt="Gru's dillemma before using snapshots"></p>
<div class="codeMirror-wrapper newest" contenteditable="false">
 <div contenteditable="false">
  <div class="codeHeader">
   <div class="nameLanguage">
    C#
   </div><i class="icon-cancel-circled-1 cm-remove">&nbsp;</i>
  </div>
  <div class="codeMirror-code--wrapper" data-code="var snapshot = snapshots.LastOrDefault();
state.LoadFromSnapshot(snapshot);
foreach (var domainEvent in orderedDomainEvents.Where(x => x.Version > snapshot.Version))
{
    state.Apply(domainEvent);
}
" data-lang="text/x-csharp">
   <pre><code lang="text/x-csharp">var snapshot = snapshots.LastOrDefault();
state.LoadFromSnapshot(snapshot);
foreach (var domainEvent in orderedDomainEvents.Where(x =&gt; x.Version &gt; snapshot.Version))
{
    state.Apply(domainEvent);
}
</code></pre>
  </div>
 </div>
</div>
<p dir="ltr"><br></p>
<ul>
 <li dir="ltr">Snapshots can be stored in a separate stream, like <code>balance-1-snapshot</code>.</li>
 <li dir="ltr">To restore the state to a certain version, retrieve the latest snapshot and apply all events with versions higher than the snapshot's version.<br><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="50.1 kB" data-mimetype="image/png" data-creationdate="1730983066987" data-creationdateformatted="11/07/2024 12:37 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027941-tech-scheme-6.png" data-modificationdate="null" data-size="50141" data-name="tech-scheme-6.png" data-id="18027941" data-src="https://dz2cdn1.dzone.com/storage/temp/18027941-tech-scheme-6.png" alt="Restore the state to a certain version"></li>
</ul>
<p dir="ltr"><br></p>
<h3 dir="ltr">Snapshot Creation Strategy</h3>
<p dir="ltr">Decide how often to create snapshots based on system usage:</p>
<ul>
 <li dir="ltr">Every N event (e.g., every 100 events),</li>
 <li dir="ltr">At specific time intervals (e.g., at the start of each new month),</li>
 <li dir="ltr">A combination of both approaches.</li>
</ul>
<p dir="ltr"><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="48.3 kB" data-mimetype="image/png" data-creationdate="1730983149312" data-creationdateformatted="11/07/2024 12:39 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027942-tech-scheme-7.png" data-modificationdate="null" data-size="48262" data-name="tech-scheme-7.png" data-id="18027942" data-src="https://dz2cdn1.dzone.com/storage/temp/18027942-tech-scheme-7.png" alt="Snapshot creation strategy (1/2)"></p>
<p dir="ltr"><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="71.1 kB" data-mimetype="image/png" data-creationdate="1730983184758" data-creationdateformatted="11/07/2024 12:39 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027943-tech-shceme-8.png" data-modificationdate="null" data-size="71102" data-name="tech-shceme-8.png" data-id="18027943" data-src="https://dz2cdn1.dzone.com/storage/temp/18027943-tech-shceme-8.png" alt="Snapshot creation strategy (2/2)"></p>
<p dir="ltr"><br></p>
<h2 dir="ltr">Main Challenges in Event Sourcing and Their Solutions</h2>
<h3 dir="ltr"><strong>1. Concurrency Updates &nbsp;</strong></h3>
<p dir="ltr">In distributed systems with multiple microservices and parallel access to data, concurrency updates and distributed transaction issues arise. The primary approaches to handling concurrency updates include:</p>
<h4><em><strong>Pessimistic Concurrency Control</strong></em></h4>
<p>This approach locks the resource (e.g., a database record) during an operation, so other processes have to wait until the lock is released. It can be implemented using distributed locks, such as with Redis or PostgreSQL.</p>
<h4><strong>Optimistic Concurrency Control</strong></h4>
<p>Instead of locking the resource, this approach relies on version checking. The object state holds a version, and during an update, it verifies that the version in the database matches the expected version. If not, the operation retries: the state is read again, validated, and updated.</p>
<p><img style="width: 600px;" class="fr-fic fr-dib lazyload" data-image="true" data-new="false" data-sizeformatted="51.3 kB" data-mimetype="image/png" data-creationdate="1730983281946" data-creationdateformatted="11/07/2024 12:41 PM" data-type="temp" data-url="https://dz2cdn1.dzone.com/storage/temp/18027948-tech-scheme-9.png" data-modificationdate="null" data-size="51300" data-name="tech-scheme-9.png" data-id="18027948" data-src="https://dz2cdn1.dzone.com/storage/temp/18027948-tech-scheme-9.png" alt="Optimistic concurrency control"><br></p>
<p dir="ltr">In event sourcing, rather than a mutable state, there’s an event stream (append-only log). This avoids concurrency update issues since new events are only appended to the end of logs. If each new event needs to depend on the previous one, optimistic version control is used, naturally supported by many event-sourcing implementations. If the dependency between events is unimportant (e.g., adding items to an order in an online store), events can be added without version checking.</p>
<h3 dir="ltr"><strong>2. Distributed Transactions&nbsp;</strong></h3>
<p dir="ltr">In distributed systems, it's crucial to ensure that changes across various data stores or services are consistent. Solutions include:</p>
<h4><strong>2-Phase Commit</strong></h4>
<p>Suitable for transactions across multiple systems, though not supported by all data stores. This process involves two stages: preparation (all participants confirm readiness) and commit, provided all are ready.</p>
<h4><strong>Outbox Pattern</strong></h4>
<p>The idea here is to <a href="https://dzone.com/articles/implementing-the-outbox-pattern">write events to an "outbox"</a> (a special messages table) in parallel with the database write. Then, a dedicated service asynchronously sends these messages to a queue, ensuring reliable delivery.</p>
<h4><strong>Transactional Saga Pattern</strong></h4>
<p>Manages distributed transactions through orchestration (centralized sequence of steps) and choreography (each step decides the next based on the current transaction state).</p>
<h3 dir="ltr">3. Projection Synchronization</h3>
<p dir="ltr">When a system uses projections for data reads, it’s essential to ensure their consistency and synchronization with the main event store. This can be achieved with:</p>
<h4 dir="ltr">Asynchronous Updates</h4>
<p dir="ltr">Projections are updated asynchronously as new events are added. A message queue can be used so that each projection receives updates automatically.</p>
<h4 dir="ltr">Eventual Consistency</h4>
<p dir="ltr">The system allows a small delay between event recording and projection updates. Ensuring all required events are processed is key.</p>
<p dir="ltr">These approaches allow for flexibility in meeting specific system requirements, maintaining consistency, and high performance in distributed environments.</p>
<h3 dir="ltr">4. Optimizing Read Process and State Computation &nbsp;</h3>
<p dir="ltr">Event sourcing involves replaying the state from all events, which can be resource-intensive for large streams. Key optimization techniques include:</p>
<h4 dir="ltr">Snapshotting</h4>
<p dir="ltr">Creating saved snapshots of an object's state at specific versions. For example, a snapshot of an account's state can be created every 100 events. This way, when replaying, the system starts from the latest snapshot and only applies new events, reducing the number of operations required to restore the current state.</p>
<h4>Projections</h4>
<p>Representing events in a convenient format for queries, such as a transaction history or current account balance. Projections can be updated in real time or periodically, depending on the specific use case.</p>
<h4>CQRS (Command Query Responsibility Segregation)</h4>
<p><a href="https://dzone.com/articles/command-query-responsibility-segregation-cqrs">This approach</a> separates write operations (event creation) from read operations (queries) into different data models. Writing is done via event sourcing, while reading is done through pre-built projections, which optimizes system performance.</p>
<h2>Conclusion</h2>
<p dir="ltr">So, while event sourcing presents challenges such as handling distributed transactions and concurrency control, these can be effectively managed through established patterns and best practices. By thoughtfully implementing this concept, teams can build applications that are more resilient, maintainable, and scalable, making it a valuable asset in modern software development.</p></div>
                  </div>

                    <div id="bottom-bumper-container"></div>
                    <div class="article-tag-pill-container">
                        <span class="article-tag-pill">Event store</span>
                        <span class="article-tag-pill">Event</span>
                        <span class="article-tag-pill">Snapshot (computer storage)</span>
                        <span class="article-tag-pill">Scalability</span>
                    </div>

                    <div class="attribution">
                      <p>Opinions expressed by DZone contributors are their own.</p>
                    </div>
                      <div class="trending-separator goto"></div>
                      <div class="trending goto">
                        <h3>Related</h3>
                        <ul>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/event-sourcing-explained-building-robust-systems">Event Sourcing Explained: Building Robust Systems With Immutable Event Logs</div>
                            </li>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/event-sourcing-in-net-core-a-gentle-introduction">Event Sourcing in .NET Core: A Gentle Introduction</div>
                            </li>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/multi-channel-notification-patterns-security-events">Multi-Channel Notification Patterns for Security-Critical Events</div>
                            </li>
                            <li class="item">
                              <div class="goto-link related-link" data-goto="/articles/synergy-of-event-driven-architectures-with-mcp">Synergy of Event-Driven Architectures With the Model Context Protocol</div>
                            </li>
                        </ul>
                      </div>
                </div>
              </article>
            </div>

              <div id="above-pr-ad" class="bottom-ad-container">
                <div id="div-gpt-ad-1435246566686-11" class="ads-bottom-leaderboard" data-gpt-slot="bottom"></div>
              </div>
              <div class="layout-card widget-top-border partner-resources-block" style="width:100%; margin-bottom: 1em;">
                <div class="main-container">
                  <div class="featured-header">
                    <h2>
                      <span>Partner Resources</span>
                    </h2>
                  </div>
                  <div class="partner-resources-container">
                    <div id="div-gpt-ad-1435246566686-5" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr1"></div>
                    <div id="div-gpt-ad-1435246566686-6" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr2"></div>
                    <div id="div-gpt-ad-1435246566686-7" class="resource-block" data-gpt-slot="partner" data-gpt-position="pr3"></div>
                  </div>
                </div>
              </div>
          </div>
        </div>
      </div>
    </div>

      <div id="bsa-parent" class="bottom-sticky-ad-container hide">
        <span class="bottom-sticky-ad-close" title="close"
          x-on:click="$el.parentElement.classList.add('closed')">×</span>
        <div id="div-gpt-ad-1635294790718-12" class="bottom-sticky-ad"></div>
      </div>

    <div class="modal fade bd-example-modal-lg" id="modal-message" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header"></div>
          <div class="modal-body"></div>
        </div>
      </div>
    </div>
  </div>
</div>
  
<div class="comments-overlay"></div>
<div id="comment-box">
  <div class="comment-box-wrapper">
    <div id="comment-input-editor"></div>
  </div>
  <div class="info hidden"></div>
  <div class="comments-content">
    <div class="comment-header">
      <hr />
      <span class="icon-comment">
        <span class="numOfComments"></span> Comments
      </span>
    </div>
    <div class="comments"></div>
  </div>
</div>

<script async>var articleTitle = 'Event Sourcing 101: When to Use and How to Avoid Pitfalls';
var articleUrl = 'https://dzone.com/articles/event-sourcing-guide-when-to-use-avoid-pitfalls';

var retweetLink = document.querySelector('#tweet-link');

function retweet(event) {
    event.preventDefault();
    event.stopPropagation();

    var twitter = 'https://twitter.com/intent/tweet';
    var params = '?text=' + encodeURIComponent(articleTitle) + '&url=' + articleUrl + '&ref=dzone.com&via=DZoneInc';
    var win = window.open(twitter + params, '_blank');
    win.focus();
}

retweetLink.addEventListener('click', retweet);

function showStatusMessage(options) {
  var modal = document.getElementById('modal-message');

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector('.modal-content .modal-body');
    var modalHeader = modal.querySelector('.modal-content .modal-header');

    modalHeader.innerText = options.header ? options.header : '';
    modalBody.innerText = options.body ? options.body : '';

    $(modal).modal('show');

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function showConfirmMessage(options) {
  var modal = document.getElementById('modal-message');

  if(modal) {
    modal.classList.add(options.type);
    var modalBody = modal.querySelector('.modal-content .modal-body');
    var modalHeader = modal.querySelector('.modal-content .modal-header');

    modalHeader.innerText = options.header ? options.header : '';
    modalBody.innerText = options.body ? options.body : '';

    if (options.textarea) {
      var textareaDiv = document.createElement('div');
      var textareaLabel = document.createElement('label');
      textareaLabel.setAttribute('for', 'modal-textarea');
      textareaLabel.innerText = options.textarea.label;

      var textarea = document.createElement('textarea');
      textarea.id = 'modal-textarea';
      textarea.placeholder = (options.textarea.placeholder || '');
      textarea.setAttribute('rows', (options.textarea.rows || 3));
      textarea.classList.add('form-control', 'not-resizable');

      if (options.textarea.maxlength) {
        textarea.maxLength = options.textarea.maxlength;
      }

      textareaDiv.appendChild(textareaLabel);
      textareaDiv.appendChild(textarea);
      modalBody.appendChild(textareaDiv);
    }

    var btnContainer = document.createElement('div');
    btnContainer.classList.add('btn-container');

    var noBtn = document.createElement('button');
    noBtn.innerText = options.noBtnText ? options.noBtnText : 'No';
    noBtn.classList.add('no-btn');

    var yesBtn = document.createElement('button');
    yesBtn.innerText = options.yesBtnText ? options.yesBtnText : 'Yes';
    yesBtn.classList.add('yes-btn');

    btnContainer.appendChild(noBtn);
    btnContainer.appendChild(yesBtn);

    modalBody.appendChild(btnContainer);

    $(modal).modal('show');

    $(noBtn).one('click', function() {
      $(modal).modal('hide');

      if(options.noCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.noCallback();
        });
      }
    });

    $(yesBtn).one('click', function() {
      $(modal).modal('hide');

      if(options.yesCallback) {
        $(modal).one('hidden.bs.modal', function () {
          options.yesCallback();
        });
      }
    });

    $(modal).on('hidden.bs.modal', function () {
      modal.classList.remove(options.type);
    });
  }
}

function getSuspensionBody() {
  return 'We regret to inform you that your DZone account has been suspended for violating our Guidelines. ' +
      'Please reach out to editors@dzone.com if you would like additional information.';
}</script>
<style>.engagement-overlay {
	width: 100%;
	height: 100%;
	position: fixed;
	top: 0;
	left: 0;
	background: rgb(0, 0, 0, 0.5);
	z-index: 10000;
}

.engagement-modal {
	display: flex;
	align-items: center;
	justify-content: center;
	position: fixed;
	z-index: 10;
	width: 100%;
	height: 100%;
}

.engagement-modal .inner {
	background-color: white;
	border-radius: 0.5em;
	margin: auto;
	border: 1px solid #cccccc;
}

.engagement-modal .header {
	padding: 20px 50px 10px 30px;
	position: relative;
}

.engagement-modal .title {
	font-size: 20px;
	font-weight: bold;
	color: #333333;
}

.engagement-modal .title:hover {
	text-decoration: none;
}

.engagement-modal .close {
	font-size: 18px;
	position: absolute;
	top: 18px;
	right: 20px;
	width: 32px;
	height: 32px;
	background: none;
	border: none;
	opacity: 0.8;
	font-weight: bold;
	text-shadow: 0 1px 0 #fff;
}

.engagement-modal .close:hover {
	background-color: rgba(146, 148, 151, 0.2);
	color: #000;
	border-radius: 50%;
}

.engagement-modal .close:after {
	content: '\2715';
}

.engagement-modal .content {
	padding: 0 30px 20px;
	width: min(450px, 90vw);
	height: min(450px, 90vw);
	scrollbar-width: thin;
	overflow: auto;
	overscroll-behavior: contain;
}

.engagement-modal .loading-screen,
.engagement-modal .content .center-screen {
	display: flex;
	justify-content: center;
	align-items: center;
	height: 100%;
	font-size: 18px;
}

.engagement-modal .content .center-screen a {
	color: var(--acc-ffffff-blue-1);
	font-weight: bold;
}

.engagement-modal .loading-screen i {
	font-size: 24px;
}

.engagement-modal .media-left,
.engagement-modal .media-right {
	display: table-cell;
	vertical-align: top;
}

.engagement-modal .media-left {
	padding-right: 10px;
}

.engagement-modal .media-right {
	padding-left: 10px;
}

.engagement-modal .media a {
	color: black;
	font-size: 16px;
}

.engagement-modal .avatar {
	border-radius: 50%;
}

.engagement-modal .footer {
	margin: 20px 0 0;
	display: flex;
	justify-content: center;
	align-items: center;
	background-color: unset !important;
	border-top: none !important;
}

.engagement-modal .footer .btn {
	border: 1px solid transparent;
}

.engagement-modal .footer .btn-primary {
	color: #fff;
	border-color: #2e6da4;
}

.engagement-modal .footer button {
	background-color: var(--acc-ffffff-blue-2);
	padding: 6px 12px;
	border-radius: 4px;
}

.engagement-modal .footer button:hover {
	filter: brightness(1.2);
}

@keyframes anim-spin {
	0% {
		transform: rotate(0deg);
	}
	100% {
		transform: rotate(359deg);
	}
}

.engagement-modal .anim-spin {
	display: inline-block;
	animation: anim-spin 2s infinite linear;
}</style>
<script>document.addEventListener('alpine:init', () => {
	Alpine.data('engagementModal', (nodeId) => ({

		nodeId: null,

		init() {
			this.nodeId = nodeId;
		},

		open() {
			this.updateStore();
			this.$store.article.engagement.open = true;
			if (this.$store.article.engagement.page === 1 && !this.$store.article.engagement.unauthorized) {
				this.$store.article.engagement.initializing = true;
				this.fetchEngagements();
			}
		},

		close() {
			if (this.$store.article.engagement.open) {
				this.$store.article.engagement.open = false;
			}
		},

		updateStore() {
			if (this.nodeId !== this.$store.article.id) {
				this.$store.article.engagement.reset();
				this.$store.article.id = this.nodeId;
			}
		},

		fetchEngagements() {
			if (this.$store.article.engagement.loading || !this.$store.article.engagement.additional) {
				return;
			}

			this.$store.article.engagement.loading = true;
			this.$store.global.getFromService('/services/nodes/' + this.$store.article.id + '/engagements?page=' + this.$store.article.engagement.page)
				.then(res => {
					res.json().then(data => {
						for (let user of data.engagements) {
							this.$store.article.engagement.users.push(user);
						}

						this.$store.article.engagement.additional = data.additional;
						this.$store.article.engagement.page++;
					});
				})
				.catch(err => {
					err.json().then(data => {
						if (data.error?.code === 4011) {
							this.$store.article.engagement.unauthorized = true;
						} else {
							this.$store.modal_engagement_error.open();
						}
					});
				})
				.finally(() => {
					// Allow the loader to gracefully exit
					setTimeout(() => {
						this.$store.article.engagement.loading = false;
						this.$store.article.engagement.initializing = false;
					}, 200);
				});
		},

		formatJobData(user) {
			if (user.profile.jobTitle && user.profile.companyName) {
				return user.profile.jobTitle + ', ' + user.profile.companyName;
			}

			if (user.profile.jobTitle) {
				return user.profile.jobTitle;
			}

			if (user.profile.companyName) {
				return user.profile.companyName;
			}

			return null;
		},

		isDataUnavailable() {
			return !this.$store.article.engagement.initializing && !this.$store.article.engagement.users.length;
		},

		isFooterShowing() {
			return !this.$store.article.engagement.initializing
				&& this.$store.article.engagement.additional
				&& this.$store.article.engagement.page > 1;
		}
	}));
});
</script>

    <div class="alpine-overlay" x-cloak x-show="$store.modal_engagement_error._open">
        <div id="modal_engagement_error"
             class="alpine-modal"
             role="dialog"
             tabindex="-1"
             x-show="$store.modal_engagement_error._open"
             x-on:click.self="$store.modal_engagement_error.dismissible && $store.modal_engagement_error.close()"
             x-cloak
             x-transition
        >
            <div class="dz-style modal-inner centered relative">
                <button x-show="$store.modal_engagement_error.closeable"
                        class="btn-close"
                        x-on:click="$store.modal_engagement_error.close()"
                        aria-label="Close">
                </button>

                <div x-show="$store.modal_engagement_error.title" class="modal-header p-sm mt-sm mb-md">
                    <div class="title " x-text="$store.modal_engagement_error.title"></div>
                </div>

                <div class="modal-content py-md px-lg" x-bind:class="{ 'has-top-border': $store.modal_engagement_error.title }">
                    <p x-show="$store.modal_engagement_error.bodyText" class="my-none" x-text="$store.modal_engagement_error.bodyText"></p>
  <p>The likes didn't load as expected. Please refresh the page and try again.</p>
                </div>

                <div x-show="$store.modal_engagement_error.options.length" class="modal-footer p-sm">
                    <template x-for="option in $store.modal_engagement_error.options">
                        <button x-show="option.canDisplay" x-text="option.text"
                                type="button"
                                x-bind:id="'button_modal_engagement_error_' + option.index"
                                x-bind:class="option.classList"
                                x-on:click="option.onClick"
                                x-bind:disabled="option.isDisabled"
                        ></button>
                    </template>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("alpine:init", () => {
            Alpine.store("modal_engagement_error", {
                _open: false,
                title: "Oops! Something Went Wrong",
                bodyText: null,
                options: [{"action":"dismiss","text":"Close"}],
                closeable: true,
                dismissible: true,
                open(data) {
                    if (data) {
                        if (data.title) {
                            this.title = data.title;
                        }
                        if (data.bodyText) {
                            this.bodyText = data.bodyText;
                        }
                        if (data.options) {
                            this.options = data.options;
                        }
                        if (data.dismissAfterMs) {
                            setTimeout(() => this._open = false, data.dismissAfterMs);
                        }
                    }
                    this.updateOptions();
                    this._open = true;
                },
                close() {
                    // Manually click the buttons in which should run on dismiss.
                    // This is to keep the context. Calling this[option.action]() will not work.
                    for (let option of this.options) {
                        if (option.runOnDismiss) {
                            const element = document.querySelector('#button_modal_engagement_error_' + option.index);
                            element.click();
                        }
                    }
                    this._open = false;
                },
                updateOptions() {
                    const btnStyle = this.options.length === 2 ? ' btn-default' : '';
                    this.options = this.options.map((o, idx) => ({
                        ...o,
                        index: idx,
                        classList: o.classList ? o.classList : (idx === 0 ? "btn btn-primary hov-brighten" : "btn hov-underline" + btnStyle),
                        onClick: function() {
                            if (o.action !== "dismiss") {
                                this[o.action]();
                            }
                            this.$store["modal_engagement_error"].close();
                        },
                        isDisabled: function() {
                            return Object.hasOwn(o, 'disabled') && this[o.disabled]();
                        },
                        canDisplay: function() {
                            return !Object.hasOwn(o, 'condition') || this[o.condition]();
                        }
                    }));
                },
                init() {
                    this.updateOptions();
                }
            });
        });
    </script>

<link rel="stylesheet" media="all" href="https://dz2cdn1.dzone.com/themes/dz20/ftl/footer/styles.css">

<div id="ftl-footer">
  <div class="container-fluid footerOuter" style="padding-bottom: 90px;">
    <div class="row">
      <div class="col-md-12">
        <div class="container">
          <div class="row footer">
            <div class="col-md-12 footerWidget">
              <div class="row footerContainer footer">
                <div class="left col-xs-12 col-sm-7">
                  <div class="col-xs-12 social-media-icons footer-mobile">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>

                  <div class="top-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ABOUT US</p>
                      <ul class="link-group">
                        <li><a href="/pages/about" rel="noreferrer noopener">About DZone</a></li>
                        <li><a href="/cdn-cgi/l/email-protection#95e6e0e5e5fae7e1d5f1effafbf0bbf6faf8" rel="noreferrer noopener">Support and feedback</a></li>
                        <li><a href="/pages/dzone-community-research">Community research</a></li>
                          <li><a href="/sitemap" rel="noreferrer noopener">Sitemap</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">ADVERTISE</p>
                      <ul class="link-group">
                        <li><a href="https://advertise.dzone.com" target="_blank" rel="noreferrer noopener">Advertise with DZone</a></li>
                      </ul>
                    </div>
                  </div>

                  <div class="bottom-section col-xs-12">
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTRIBUTE ON DZONE</p>
                      <ul class="bottom-top-list link-group">
                        <li><a href="/articles/dzones-article-submission-guidelines">Article Submission Guidelines</a></li>
                        <li><a href="/pages/contribute" rel="noreferrer noopener">Become a Contributor</a></li>
                        <li><a href="/pages/core" rel="noreferrer noopener">Core Program</a></li>
                        <li><a href="/writers-zone" rel="noreferrer noopener">Visit the Writers' Zone</a></li>
                      </ul>

                      <p class="section-header">LEGAL</p>
                      <ul class="link-group">
                        <li><a href="https://technologyadvice.com/terms-conditions/" target="_blank" rel="noreferrer noopener">Terms of Service</a></li>
                        <li><a href="https://technologyadvice.com/privacy-policy/" target="_blank" rel="noreferrer noopener">Privacy Policy</a></li>
                      </ul>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                      <p class="section-header">CONTACT US</p>
                      <ul class="link-group">
                        <li>3343 Perimeter Hill Drive</li>
                        <li>Suite 100</li>
                        <li>Nashville, TN 37211</li>
                        <li><a href="/cdn-cgi/l/email-protection#0e7d7b7e7e617c7a4e6a7461606b206d6163" rel="noreferrer noopener"><span class="__cf_email__" data-cfemail="f4878184849b8680b4908e9b9a91da979b99">[email&#160;protected]</span></a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="right col-xs-12 col-sm-5">

                  <p class="connect-text">Let's be friends:</p>
                  <div class="col-xs-12 social-media-icons footer-wide">
                    <ul class="icons-only">
                      <li class="rss-icon" id="rss-footer-1">
                        <a href="/pages/feeds" target="_blank" rel="noreferrer noopener">
                          <i class="icon-rss-1"></i>
                        </a>
                      </li>
                      <li class="twitter-icon">
                        <a href="https://twitter.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-twitter"></i>
                        </a>
                      </li>
                      <li class="facebook-icon">
                        <a href="https://www.facebook.com/DZoneInc" target="_blank" rel="noreferrer noopener">
                          <i class="icon-facebook-1"></i>
                        </a>
                      </li>
                      <li class="linkedin-icon">
                        <a href="https://www.linkedin.com/company/dzone/" target="_blank"
                           rel="noreferrer noopener">
                          <i class="icon-linkedin-1"></i>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

  <script async>
      (function(w, d, s, l, i) {
          w[l] = w[l] || [];
          w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
          var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
          j.async = true;
          j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
          f.parentNode.insertBefore(j,f);
      })(window, document, 'script', 'dataLayer', 'GTM-K25QL22');
  </script>

  <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-410289-1', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('require', 'GTM-TSD9TZP');
      ga('set', 'siteSpeedSampleRate', 25);
  </script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>
  <script async>var analytics = {
    'dimension1': 'Performance',
    'dimension2': 'article/analysis',
    'dimension3': '2025-03-14',
    'dimension4': '0',
    'dimension5': '',
    'dimension7': 'Event store, event, snapshot, Scalability',
    'dimension8': 'VRybnikov',
    'dimension9': 'undefined',
    'dimension10': 'Innovecs'
};

if (window.ga) {
    Object.keys(analytics).forEach(function(key) {
        window.ga('set', key, analytics[key]);
    });

    window.ga('send', 'pageview');
}</script>

  <script>
      const articleId = 3510154;
      const likes = 5;
      const assetDomain = 'https://dz2cdn1.dzone.com';
      const codemirrorVars = {
          modeURI: 'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/mode/',
          requiredScripts: [
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.js',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/addon/mode/multiplex.js',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/mode/meta.js'
          ]
      };

      const gptTags = {
          'zone': 'Performance',
          'topicTag': 'Event store,event,snapshot,Scalability',
          'company': '',
          'siteSection': 'Zones',
          'articleCategory': 'analysis',
          'nodeID': '3510154',
          'authorID': '5238181',
          'publishYear': '2025',
          'publishMonth': '03',
          'jobRole': '',
          'companySize': '',
          'env': 'prod'
      };

      const minCommentChar = 10;

        const ctaModel = null;
  </script>

  <script src="https://dz2cdn1.dzone.com/themes/dz20/lib/static/jquery/jquery.min.js"></script>
  <script async src="https://dz2cdn1.dzone.com/themes/dz20/lib/static/bootstrap/bootstrap.min.js"></script>
  <script async src="https://dz2cdn1.dzone.com/themes/dz20/ftl/article/ads.js" onload="loadCTAIntoPage()"></script>

  <script>
      function loadScript(src) {
          return new Promise(function (resolve, reject) {
              const s = document.createElement('script');
              s.src = src;
              s.onload = resolve;
              s.onerror = reject;
              document.head.appendChild(s);
          });
      }

      function loadStyle(href) {
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = href;
          document.head.appendChild(link);
      }

      function loadScriptsSync(deferred) {
          var p = Promise.resolve();
          for (var i = 0; i < deferred.length; i++) {
              let script = deferred[i];
              p = p.then(function() {
                  return loadScript(script);
              });
          }
          return p;
      }

      function loadStyles() {
          const deferred = [
              'https://dz2cdn1.dzone.com/themes/dz20/lib/codemirror/lib/codemirror.css',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/comments/styles.css',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/css/froala_editor.pkgd.min.css',
              'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/css/themes/gray.min.css',
              'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/mini-profile.css'
          ];

          for (var i = 0; i < deferred.length; i++) {
              loadStyle(deferred[i]);
          }
      }

      window.addEventListener('load', function(_event) {
          loadStyles();

          loadScriptsSync([
            'https://dz2cdn1.dzone.com/themes/dz20/lib/lazysizes.min.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/codeblocks.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/activity-bar.js',
            'https://dz2cdn1.dzone.com/themes/dz20/lib/froala3/js/froala_editor.pkgd.min.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/froala/content.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/comments/content.js',
            'https://dz2cdn1.dzone.com/themes/dz20/ftl/article/content.js'
          ]);
      });
  </script>
</body>
</html>